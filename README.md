# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом
- src/components/model/ — папка с кодом модели
- src/components/view/ — папка с кодом отображения

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами
- src/components/base/api.ts - базовый класс работы с API
- src/components/base/events.ts - базовый класс работы с событиями
- src/components/base/form.ts - базовый класс форм
- src/components/model/appApi.ts - класс для работы с API WEB LAREK
- src/components/model/appModel.ts - класс модели приложения
- src/components/view/basket.ts - класс отображения корзины
- src/components/view/card.ts - класс отображения карточек
- src/components/view/formAddress.ts - класс отображения формы контактных данных
- src/components/view/formOrder.ts - класс отображения формы способа оплаты и адреса
- src/components/view/modal.ts - класс отображения модального окна
- src/components/view/orderSuccess.ts - класс отображения успешного заказа
- src/components/view/page.ts - класс отображения главной страницы

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```



## Форматы данных

### Товар (IProduct)
```typescript
{
  id: string;             // Уникальный идентификатор
  title: string;          // Название товара
  description: string;    // Описание товара
  price: number;          // Цена товара
  category: ProductCategory; // Категория товара
  image: string;          // URL изображения
  quantity?: number;      // Опциональное поле для количества
}
```


### Заказ (IOrder)
```typescript
{
  payment: string;        // Способ оплаты: "card" | "cash"
  address: string;        // Адрес доставки
  email: string;          // Электронная почта
  phone: string;          // Телефон
  items: string[];        // Массив ID товаров
  total: number;         // Общая сумма заказа
}
```


### Результат заказа (IOrderResult)
```typescript
{
  id: string;             // Идентификатор заказа
  total: number;          // Итоговая сумма
}
```


### События приложения (AppEvents)
```typescript
{
  BasketOpen = 'modal:open-basket', // Открытие корзины
  CardSelect = 'card:select',       // Выбор карточки
  CardAddBasket = 'card:add-basket', // Добавление карточки в корзину
  BasketChanged = 'basket:changed', // Изменение в корзине
  BasketDeleteItem = 'basket:delete-item', // Удаление из корзины
  BasketSubmit = 'basket:order', // Событие нажатия на кнопку оформить в корзине
  FormOrderSubmit = 'formOrder:submit', // Событие нажатия на кнопку далее формы выбора способа оплаты ...
  FormContactSubmit = 'formContact:submit', // Событие нажатия на кнопку далее формы указания email и номера телефона
  OrderSuccessSubmit = 'orderSuccess:submit', // Событие нажатия на кнопку "За новыми покупками" в окне успешного заказа
  ModalOpen = 'modal:open', // Событие открытия модального окна
  ModalClose = 'modal:close' // Событие закрытия модального окна
}
```


### Тип платежа (OrderPayment)
```typescript
"card" | "cash";
```



### Эндпоинты

#### 1. Получение всех товаров
- **URL**: `GET /product`
- **Ответ**:
```json
{
    "total": 15,
    "items": [
      {
        "id": "123",
        "title": "Название товара",
        "description": "Описание товара",
        "price": 1000,
        "category": "софт-скил",
        "image": "/images/product-123.jpg"
      },
      // и т.д.
    ]
  }
```


#### 2. Получение товара по ID
- **URL**: `GET /product/:id`
- **Параметры**:
    - `id`: ID товара
- **Ответ**:
```json
{
    "id": "123",
    "title": "Название товара",
    "description": "Описание товара",
    "price": 1000,
    "category": "софт-скил",
    "image": "/images/product-123.jpg"
  }
```


#### 3. Оформление заказа
- **URL**: `POST /order`
- **Тело запроса**:
```json
{
    "payment": "card",
    "address": "г. Москва, ул. Примерная, д. 1",
    "email": "user@example.com",
    "phone": "+7 (123) 456-78-90",
    "items": ["123", "456"]
  }
```

- **Ответ**:
```json
{
    "id": "order-789",
    "total": 2500
  }
```


## Архитектура

### Паттерн MVP

Проект реализован с использованием архитектурного паттерна MVP (Model-View-Presenter):

- **Model (Модель)**:
    - Отвечает за хранение и управление данными
    - Не зависит от представления и презентера
    - Взаимодействует с другими компонентами через систему событий

- **View (Представление)**:
    - Отвечает за отображение данных пользователю
    - Включает компоненты пользовательского интерфейса
    - Передает действия пользователя презентеру через события

- **Presenter (Презентер)**:
    - Является связующим звеном между моделью и представлением
    - Реагирует на события от представления и модели
    - Реализован в основном файле приложения index.ts

### Система событий

Компоненты взаимодействуют друг с другом через систему событий (EventEmitter), что обеспечивает:
- Слабую связанность компонентов (компоненты не зависят напрямую друг от друга)
- Гибкую архитектуру, легкую для модификации и расширения



## Основные компоненты

### 1. **`api.ts`**
Базовый класс для работы с HTTP-запросами:
- **Методы**:
    - `get`: выполнение GET-запроса
    - `post`: выполнение POST/PUT/DELETE-запроса
    - `handleResponse`: обработка ответа от сервера


### 2. **`events.ts`**
Реализация брокера событий:
- **Методы**:
    - `on`: подписка на события
    - `off`: отписка от событий
    - `emit`: генерация события
    - `onAll`: подписка на все события
    - `offAll`: отмена всех подписок
    - `trigger`: создание функции-триггера для определённого события


### 3. **`form.ts`**
Абстрактный класс для форм:
- **Методы**:
    - `errorValidationShow`: Устанавливает текст ошибки валидации
    -`errorValidationClear`: Очищает поле ошибок валидации
    -`toggleSubmith`: Блокировка/разблокировка кнопки
    -`render`: Абстрактный метод возвращающий разметку формы


### 4. **`appApi.ts`**
Класс для взаимодействия с API интернет-магазина:
- **Методы**:
    - `getItemList`: получение списка товаров
    - `postOrder`: отправка заказа на сервер


### 5. **`appModel.ts`**
Центральная модель приложения:
- **Свойства**:
    - `_itemList`: список товаров в каталоге
    - `order`: информация о текущем заказе
    - `_basketList`: список товаров в корзине
    - `_totalPrice`: Общая цена товаров в корзине
- **Геттеры**:
    - `itemList`: Получить список товаров
    - **Cеттеры**:
    - `totalPrice`: Устанавливает общую стоимость товаров в корзине
    - `basketAdd`: Добавляет товар в корзину
    - `itemList`: Установить список товаров
- **Методы**:
    - `basketRemove`: удаление товара из корзины
    - `basketCount`: получить кол-во товаров в корзине
    - `getItemById`: получить товар по id
    - `getBasketItems`: получить все товары из корзины с полной информацией
    - `clearBasket`: очистка списка корзины
    - `avilabilityInBasket`: проверка наличия в корзине
    - `addToOrderData`: метод сборки данных заказа для отправки
    - `getOrderData`: метод для получения данных заказа для отправки


### 6. **`basket.ts`**
Класс отображения корзины:
- **Методы**:
    - `totalPrice`: Получить общую стоимость товаров в корзине
    - `createBasketItem`: Создание разметки одного элемента корзины
    - `formatPrice`: Форматирование цены
    - `clearBasketItems`: Очистка разметки элементов корзины
    - `BasketButtonDisabled` / `BasketButtonEnable`: Доступность кнопки выкл/вкл
    - `updateTotalPrice`: Обновление счетчика товаров в корзине
    - `render`: Создание разметки корзины


### 7. **`card.ts`**
Класс отображения карточек:
- **Методы**:
    - `toggleButtonBuyText`: Смена текста кнопки добавления в корзину
    - `renderCatalogCardItem`: Создание разметки для карточек каталога
    - `renderPreviewCardItem`: Создание разметки для превью карточек


### 8. **`formAddress.ts`**
Класс отображения формы контактных данных :
- **Методы**:
    - `validateEmail`: Валидация поля Email
    - `validatePhone`: Валидация поля Phone
    - `toggleButtonState`: Смена состояния кнопки
    - `getInputData`: Получение данных из полей
    - `render`: Создание разметки формы


### 9. **`formOrder.ts`**
Класс отображения формы способа оплаты и адреса:
- **Методы**:
    - `handleButtonPayClick`: Обработчик выбора способа оплаты
    - `validateForm`: Валидация поля формы
    - `clearForm`: Очистка формы
    - `getInputData`: Получение данных из полей
    - `render`: Создание разметки формы


### 10. **`modal.ts`**
Класс отображения модального окна:
- **Методы**:
    - `handlePropagation`: Остановка всплытия события клика
    - `clearModal`: Очистка окна
    - `handleClose`: Обработчик закрытия окна
    - `close / open`: Закрытие и открытие окна
    - `render`: Создание разметки окна


### 11. **`orderSuccess.ts`**
Класс отображения окна успешного заказа:
- **Методы**:
    - `totalPrice`: Установка общей стоимости
    - `render`: Создание разметки окна


### 12. **`page.ts`**
Класс отображения содержимого главной страницы:
- **Методы**:
    - `renderSingle`: Создание разметки одного элемента каталога
    - `renderBasketCount`: Обновление счетчика корзины
    - `render`: Создание общей разметки 